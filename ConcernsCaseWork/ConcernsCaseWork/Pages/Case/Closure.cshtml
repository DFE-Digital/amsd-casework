@page "/case/{id:long}/management/closure"
@model ConcernsCaseWork.Pages.Case.ClosurePageModel

<partial name="_Error"></partial>

<div tabindex="-1" role="group" id="errorSummary" class="govuk-error-summary moj-hidden" aria-labelledby="error-summary-title" data-module="error-summary"></div>

<h1 class="govuk-heading-l"> Close case @Model.CaseModel.Urn  </h1>
<h2 class="govuk-heading-s">@Model.CaseModel.TrustName</h2>

<form role="form" asp-page-handler="closeCase" method="post" id="close-case-form" novalidate>

	<div class="govuk-character-count" data-module="govuk-character-count" data-maxlength="200">
		<div class="govuk-form-group">
			<h1 class="govuk-label-wrapper">
				<legend class="govuk-heading-m">
					Case outcomes
				</legend>
			</h1>
			<textarea class="govuk-textarea govuk-js-character-count concern-auto-resize" id="case-outcomes" name="caseOutcomes" rows="3" aria-describedby="case outcomes"></textarea>
		</div>
		<div id="case-outcomes-info" class="govuk-hint govuk-character-count__message" aria-live="polite">
			You can enter up to 200 characters
		</div>
	</div>

	<div class="govuk-form-group govuk-!-margin-top-9">
		<fieldset class="govuk-fieldset">

			<legend class="govuk-heading-m">
				Do you need to close this case for monitoring?
			</legend>

			<div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">

				<div class="govuk-radios__item">
					<input class="govuk-radios__input" data-aria-controls="close-for-monitoring-yes" id="monitoring-yes" name="monitoring" type="radio" value="Yes">
					<label class="govuk-label govuk-radios__label" for="monitoring-yes">
						Yes
					</label>
				</div>

				<div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="close-for-monitoring-yes">
					<div class="govuk-form-group">
						<legend class="govuk-fieldset__legend govuk-!-font-weight-bold">
							Date to review
						</legend>
						<div class="govuk-date-input" id="dateCreated">
							<div class="govuk-date-input__item">
								<div class="govuk-form-group">
									<label class="govuk-label govuk-date-input__label" for="dateCreatedDay">
										Day
									</label>
									<input class="govuk-input govuk-date-input__input govuk-input--width-2" id="dateCreatedDay" name="dateCreatedDay" type="text" pattern="[0-9]*" inputmode="numeric">
								</div>
							</div>
							<div class="govuk-date-input__item">
								<div class="govuk-form-group">
									<label class="govuk-label govuk-date-input__label" for="dateCreatedMonth">
										Month
									</label>
									<input class="govuk-input govuk-date-input__input govuk-input--width-2" id="dateCreatedMonth" name="dateCreatedMonth" type="text" pattern="[0-9]*" inputmode="numeric">
								</div>
							</div>
							<div class="govuk-date-input__item">
								<div class="govuk-form-group">
									<label class="govuk-label govuk-date-input__label" for="dateCreatedYear">
										Year
									</label>
									<input class="govuk-input govuk-date-input__input govuk-input--width-4" id="dateCreatedYear" name="dateCreatedYear" type="text" pattern="[0-9]*" inputmode="numeric">
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="govuk-radios__item">
					<input class="govuk-radios__input" data-aria-controls="close-for-monitoring-no" id="monitoring-no" name="monitoring" type="radio" value="No">
					<label class="govuk-label govuk-radios__label" for="monitoring-no">
						No
					</label>
				</div>

			</div>

		</fieldset>
	</div>

	<!--Close case-->
	<button data-prevent-double-click="true" class="govuk-button govuk-!-margin-top-6" data-module="govuk-button">
		Close case
	</button>

</form>

<script type="application/javascript">
	$(function () {	
		let validator = formValidator($("#close-case-form")[0]);
		validator.addValidator('caseOutcomes', [{
			method: function(field) {
				return field.value.trim().length > 0;
			},
			message: 'Case outcomes is required'
		}]);
		
		autoResizer();
	});
</script>